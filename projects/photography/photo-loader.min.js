!function(){"use strict";const e=[{file:"68223264_Unknown.JPG",date:"2017-08-21"},{file:"IMG_1325_result.jpg",date:"2024-06-22"},{file:"IMG_1352_result.jpg",date:"2024-06-25"},{file:"IMG_1395_result.jpg",date:"2024-06-28"},{file:"IMG_1992_result_1.jpg",date:"2024-08-12"},{file:"IMG_2010_result_1.jpg",date:"2024-08-13"},{file:"image0.jpeg",date:"2024-12-10"},{file:"IMG_4037_result_1.jpg",date:"2025-01-14"},{file:"IMG_5567_result.jpg",date:"2025-03-10"},{file:"IMG_6346_result_1.jpg",date:"2025-04-04"},{file:"IMG_6582_result.jpg",date:"2025-04-09"},{file:"IMG_7624_result_1.jpg",date:"2025-05-29"},{file:"IMG_8446_result.jpg",date:"2025-06-17"},{file:"IMG_8419_result.jpg",date:"2025-06-17"},{file:"IMG_8332_result.jpg",date:"2025-06-17"},{file:"IMG_8612_result.jpg",date:"2025-06-18"},{file:"IMG_8606_result.jpg",date:"2025-06-18"},{file:"IMG_8513_result.jpg",date:"2025-06-18"},{file:"IMG_8493_result.jpg",date:"2025-06-18"},{file:"IMG_8464_result.jpg",date:"2025-06-18"},{file:"IMG_8818_result.jpg",date:"2025-06-19"},{file:"IMG_8739_result.jpg",date:"2025-06-19"},{file:"IMG_8727_result.jpg",date:"2025-06-19"},{file:"IMG_9017_result.jpg",date:"2025-06-20"},{file:"IMG_9007_result.jpg",date:"2025-06-20"},{file:"IMG_9810_result_1.jpg",date:"2025-08-03"},{file:"IMG_0236_result.jpg",date:"2025-09-08"},{file:"vlcsnap-2025-11-12-02h05m05s496.jpg",date:"2025-09-20"},{file:"IMG_0772_result.jpg",date:"2025-10-21"},{file:"IMG_0969_result.jpg",date:"2025-11-02"},{file:"IMG_0966_result.jpg",date:"2025-11-02"},{file:"IMG_0955_result.jpg",date:"2025-11-02"},{file:"IMG_1264_result.jpg",date:"2025-11-09"},{file:"IMG_1238_result.jpg",date:"2025-11-09"},{file:"IMG_1443_result_1.jpg",date:"2025-11-13"},{file:"IMG_1463_result.jpg",date:"2025-11-16"},{file:"IMG_1507_result.jpg",date:"2025-11-24"},{file:"IMG_1574_result.jpg",date:"2025-11-27"},{file:"IMG_1659_result.jpg",date:"2025-11-28"},{file:"IMG_1649_result.jpg",date:"2025-11-28"},{file:"IMG_1648_result.jpg",date:"2025-11-28"}],t="images/";let o=0,n=[];const l=window.matchMedia("(max-width: 768px)").matches;let i="grid";function a(e){const[t,o,n]=e.split("-").map(Number);return new Date(t,o-1,n)}const s={loading:document.getElementById("loading"),noPhotos:document.getElementById("no-photos"),galleryLayout:document.getElementById("gallery-layout"),photoDate:document.getElementById("photo-date"),photoLocation:document.getElementById("photo-location"),locationItem:document.getElementById("location-item"),photoFilename:document.getElementById("photo-filename"),photoCount:document.getElementById("photo-count"),mainPhoto:document.getElementById("main-photo"),timelineTrack:document.getElementById("timeline-track"),timelineScroll:document.getElementById("timeline-scroll"),photoDimensions:document.getElementById("photo-dimensions"),photoAspect:document.getElementById("photo-aspect"),photoCamera:document.getElementById("photo-camera"),photoSettings:document.getElementById("photo-settings"),photoFlash:document.getElementById("photo-flash"),photoColorSpace:document.getElementById("photo-color-space"),photoSoftware:document.getElementById("photo-software"),flashItem:document.getElementById("flash-item"),colorSpaceItem:document.getElementById("color-space-item"),softwareItem:document.getElementById("software-item"),exifSection:document.getElementById("exif-section"),hoverInfo:document.getElementById("hover-info"),zoomOverlay:document.getElementById("zoom-overlay"),zoomIn:document.getElementById("zoom-in"),zoomOut:document.getElementById("zoom-out"),zoomReset:document.getElementById("zoom-reset"),zoomLevel:document.getElementById("zoom-level"),mobileGridView:document.getElementById("mobile-grid-view"),mobileGrid:document.getElementById("mobile-grid"),mobileInfoBtn:document.getElementById("mobile-info-btn"),mobileCloseBtn:document.getElementById("mobile-close-btn")};function r(){console.log(`Building timeline with ${n.length} photos`);const e=new Map;n.forEach((t,o)=>{const n=a(t.date),l=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`;e.has(l)||e.set(l,[]),e.get(l).push({...t,globalIndex:o})});const t=a(n[0].date),o=a(n[n.length-1].date),l=[];let i=new Date(t.getFullYear(),t.getMonth(),1);const r=new Date(o.getFullYear(),o.getMonth(),1);for(;i<=r;){const t=`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`;l.push({key:t,year:i.getFullYear(),month:i.getMonth(),photos:e.get(t)||[]}),i.setMonth(i.getMonth()+1)}console.log(`Generated ${l.length} monthly ticks`);const d=Math.max(...l.map(e=>e.photos.length),0);console.log(`Max photos in a single month: ${d}`),s.timelineTrack.innerHTML="";let c=null;l.forEach(e=>{const{year:t,month:o,photos:l}=e,i=t!==c,a=document.createElement("div");if(a.className="tick-mark",a.dataset.monthKey=e.key,i&&(a.classList.add("year"),c=t),l.length>0){a.classList.add("has-photos");const e=document.createElement("div");e.className="tick-previews",l.forEach((t,o)=>{const l=document.createElement("div");l.className="tick-thumbnail",l.dataset.photoIndex=t.globalIndex,l.dataset.photoNumber=t.globalIndex+1,l.addEventListener("mouseenter",()=>{s.hoverInfo&&(s.hoverInfo.textContent=`Photo ${l.dataset.photoNumber} of ${n.length}`,s.hoverInfo.classList.add("visible"))}),l.addEventListener("mouseleave",()=>{s.hoverInfo&&s.hoverInfo.classList.remove("visible")}),l.addEventListener("click",e=>{e.stopPropagation(),clearTimeout(f),y=!0,b=Date.now(),p(t.globalIndex),f=setTimeout(()=>{y=!1},1e3)}),e.appendChild(l)}),a.appendChild(e)}else a.classList.add("empty");const r=document.createElement("div");r.className="tick-line",a.appendChild(r);const d=document.createElement("div");d.className="tick-label";const m=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];i?(d.textContent=t,d.dataset.year=t,d.dataset.month=m[o]):d.textContent=m[o],a.appendChild(d),s.timelineTrack.appendChild(a)}),console.log(`Built ${l.length} tick marks`),function(e){const t=document.querySelector(".timeline-container"),o=document.querySelector(".timeline-scroll"),n=document.querySelector(".timeline-track");if(!t)return;const l=50+6*e+0+8,i=Math.max(70,Math.min(300,l));t.style.height=`${i}px`,t.style.minHeight=`${i}px`,o&&(o.style.minHeight=`${i}px`),n&&(n.style.minHeight=`${i}px`),document.documentElement.style.setProperty("--timeline-height",`${i}px`),console.log(`Timeline height adjusted to ${i}px for ${e} max stacked boxes`)}(d)}let d,c=null;function m(e){i="photo",s.mobileGridView&&(s.mobileGridView.style.display="none"),s.galleryLayout&&(s.galleryLayout.style.display="flex",s.galleryLayout.classList.add("photo-mode")),y=!0,b=Date.now(),p(e),setTimeout(()=>{y=!1},1e3)}function u(){i="grid",s.galleryLayout&&(s.galleryLayout.style.display="none",s.galleryLayout.classList.remove("photo-mode")),s.mobileGridView&&(s.mobileGridView.style.display="block"),g();const e=window.location.pathname;window.history.pushState({},"",e)}function h(){const e=document.querySelector(".photo-metadata"),t=document.querySelector(".gallery-layout");e&&(e.classList.toggle("mobile-visible"),t&&t.classList.toggle("info-visible"))}function g(){const e=document.querySelector(".photo-metadata"),t=document.querySelector(".gallery-layout");e&&(t&&t.classList.remove("info-visible"),e.classList.remove("mobile-visible"))}function p(e,i=!1,r=!0){if(e<0||e>=n.length)return;o=e;const d=n[e],c=e+1,m=`${window.location.pathname}?photo=${c}`;window.history.pushState({photoIndex:e},"",m),C(),s.mainPhoto.classList.remove("visible"),setTimeout(()=>{s.mainPhoto.src=d.src||t+d.file;const o=d.width>d.height?"landscape":"portrait";s.mainPhoto.setAttribute("data-orientation",o);const l=a(d.date).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});s.photoDate.textContent=l,d.exif&&d.exif.latitude&&d.exif.longitude?(s.photoLocation.textContent="Loading location...",s.locationItem.style.display="block",async function(e,t){try{const o=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${e}&lon=${t}&zoom=10&addressdetails=1`,{headers:{"User-Agent":"Photography Gallery/1.0"}});if(!o.ok)throw new Error("Geocoding request failed");const n=(await o.json()).address||{},l=n.city||n.town||n.village||n.hamlet||n.county||n.state||"Unknown Location",i=n.country;return i?`${l}, ${i}`:l}catch(e){throw e}}(d.exif.latitude,d.exif.longitude).then(e=>{s.photoLocation.textContent=e}).catch(e=>{console.warn("Reverse geocoding failed:",e);const t=d.exif.latitude.toFixed(6),o=d.exif.longitude.toFixed(6),n=d.exif.latitude>=0?"N":"S",l=d.exif.longitude>=0?"E":"W";s.photoLocation.textContent=`${Math.abs(t)}° ${n}, ${Math.abs(o)}° ${l}`})):(s.photoLocation.textContent="—",s.locationItem.style.display="block"),s.photoFilename.textContent=d.file,s.photoCount.textContent=`Photo ${e+1} of ${n.length}`;const i=function(e,t){const o=(e,t)=>0===t?e:o(t,e%t),n=o(e,t),l=e/n,i=t/n,a=e/t;return Math.abs(a-16/9)<.01?"16:9":Math.abs(a-4/3)<.01?"4:3":Math.abs(a-1.5)<.01?"3:2":Math.abs(a-1)<.01?"1:1 (Square)":Math.abs(a-21/9)<.01?"21:9":`${l}:${i}`}(d.width,d.height);s.photoDimensions.textContent=`${d.width} × ${d.height}px`,s.photoAspect.textContent=i,s.exifSection.style.display="block";const r=d.exif?[d.exif.Make,d.exif.Model].filter(Boolean).join(" "):"";s.photoCamera.textContent=r||"—";const c=[];if(d.exif?.ISO&&c.push(`ISO ${d.exif.ISO}`),d.exif?.FNumber&&c.push(`f/${d.exif.FNumber}`),d.exif?.ExposureTime){const e=d.exif.ExposureTime<1?`1/${Math.round(1/d.exif.ExposureTime)}s`:`${d.exif.ExposureTime}s`;c.push(e)}if(d.exif?.FocalLength&&c.push(`${d.exif.FocalLength}mm`),s.photoSettings.textContent=c.length>0?c.join(" · "):"—",void 0!==d.exif?.Flash){const e=!!(1&d.exif.Flash);s.photoFlash.textContent=e?"Fired":"Not Fired"}else s.photoFlash.textContent="—";if(s.flashItem.style.display="block",void 0!==d.exif?.ColorSpace){const e={1:"sRGB",65535:"Uncalibrated",2:"Adobe RGB"};s.photoColorSpace.textContent=e[d.exif.ColorSpace]||d.exif.ColorSpace}else s.photoColorSpace.textContent="—";s.colorSpaceItem.style.display="block",s.photoSoftware.textContent=d.exif?.Software||"—",s.softwareItem.style.display="block",setTimeout(()=>{s.mainPhoto.classList.add("visible")},50)},200),document.querySelectorAll(".tick-thumbnail").forEach(t=>{t.dataset.photoIndex===String(e)?t.classList.add("active"):t.classList.remove("active")});const u=a(d.date),h=`${u.getFullYear()}-${String(u.getMonth()+1).padStart(2,"0")}`,g=u.getMonth(),p=u.getFullYear();let y=null;11===g?y=`${p+1}-01`:1===g&&(y=`${p}-01`),document.querySelectorAll(".tick-mark").forEach(e=>{const t=e.querySelector(".tick-label");e.dataset.monthKey===h?(e.classList.add("active"),t.dataset.year&&t.dataset.month&&(t.textContent=t.dataset.month)):(e.classList.remove("active"),t.dataset.year&&(e.dataset.monthKey===y?t.style.opacity="0":(t.style.opacity="",t.textContent=t.dataset.year)))}),i||function(e,t=!0){const o=n[e];if(!o)return;const l=a(o.date),i=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`,r=document.querySelectorAll(".tick-mark");for(let e of r)if(e.dataset.monthKey===i){const o=s.timelineScroll,n=e.offsetLeft+e.offsetWidth/2;o.scrollTo({left:n,behavior:t?"smooth":"auto"});break}}(e,r),M(),l&&function(){const e=document.getElementById("mobile-timeline-indicator"),t=document.getElementById("mobile-timeline-current");if(!e)return;const l=n[o];if(!l)return;const i=a(l.date),s=o/(n.length-1||1)*100;e.style.left=`${s}%`,t&&(t.textContent=`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][i.getMonth()]} ${i.getFullYear()} · Photo ${o+1} of ${n.length}`)}()}let y=!1,f=null,v=0,b=0;function x(){const e=s.timelineScroll.getBoundingClientRect(),t=e.left+e.width/2,l=document.querySelectorAll(".tick-mark.has-photos");let i=null,r=1/0;if(l.forEach(e=>{const o=e.getBoundingClientRect(),n=o.left+o.width/2,l=Math.abs(n-t);l<r&&(r=l,i=e)}),i&&i.dataset.monthKey){const e=i.dataset.monthKey,t=n[o];if(t){const o=a(t.date),l=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`;if(e!==l){const t=n.findIndex(t=>{const o=a(t.date);return`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`===e});-1!==t&&p(t,!0)}}return i}return null}function I(e){if(0===n.length)return;let t;t="prev"===e?o>0?o-1:o:o<n.length-1?o+1:o,t!==o&&(clearTimeout(f),y=!0,b=Date.now(),p(t,!1,!1),f=setTimeout(()=>{y=!1},300))}function M(){const e=document.getElementById("nav-prev"),t=document.getElementById("nav-next");e&&t&&(0===o?e.classList.add("disabled"):e.classList.remove("disabled"),o===n.length-1?t.classList.add("disabled"):t.classList.remove("disabled"))}s.timelineScroll.addEventListener("scroll",()=>{if(y)return;const e=Date.now();e-b<2e3||(e-v>50&&(x(),v=e),clearTimeout(d),d=setTimeout(()=>{const e=x();if(e){const t=s.timelineScroll,o=t.getBoundingClientRect(),n=o.left+o.width/2,l=e.getBoundingClientRect(),i=l.left+l.width/2,a=t.scrollLeft+(i-n);t.scrollTo({left:a,behavior:"smooth"})}},150))});let $=1,E=1,w=4,L=!1,_=0,S=0,k=0,B=0;function G(){if(1===$&&0===k&&0===B)s.mainPhoto.style.transform="",s.mainPhoto.classList.remove("zoomable");else{const e=`translate(${k}px, ${B}px) scale(${$})`;s.mainPhoto.style.transform=e,$>1?s.mainPhoto.classList.add("zoomable"):s.mainPhoto.classList.remove("zoomable")}s.zoomLevel&&(s.zoomLevel.textContent=`${Math.round(100*$)}%`),s.zoomIn&&s.zoomOut&&s.zoomReset&&($>=w?s.zoomIn.classList.add("disabled"):s.zoomIn.classList.remove("disabled"),$<=E?s.zoomOut.classList.add("disabled"):s.zoomOut.classList.remove("disabled"),1===$?s.zoomReset.classList.add("disabled"):s.zoomReset.classList.remove("disabled"))}function C(){$=1,k=0,B=0,G()}s.mainPhoto.addEventListener("wheel",e=>{if(e.ctrlKey||0!==e.deltaY){e.preventDefault();const t=$,o=Math.abs(e.deltaY)>50?.1:.05;$=e.deltaY<0?Math.min($+o,w):Math.max($-o,E),$!==t&&G()}},{passive:!1}),s.mainPhoto.addEventListener("mousedown",e=>{$>1&&(e.preventDefault(),L=!0,_=e.clientX-k,S=e.clientY-B)}),document.addEventListener("mousemove",e=>{if(L&&$>1){e.preventDefault();const t=e.clientX-_,o=e.clientY-S,n=s.mainPhoto.getBoundingClientRect(),l=s.mainPhoto.parentElement.getBoundingClientRect(),i=n.width*$,a=n.height*$,r=Math.max(0,(i-l.width)/2),d=Math.max(0,(a-l.height)/2);k=Math.max(-r,Math.min(r,t)),B=Math.max(-d,Math.min(d,o)),G()}}),document.addEventListener("mouseup",()=>{L=!1});let j=0,F=1;s.mainPhoto.addEventListener("touchstart",e=>{if(2===e.touches.length){e.preventDefault();const t=e.touches[0],o=e.touches[1];j=Math.hypot(o.clientX-t.clientX,o.clientY-t.clientY),F=$}},{passive:!1}),s.mainPhoto.addEventListener("touchmove",e=>{if(2===e.touches.length){e.preventDefault();const t=e.touches[0],o=e.touches[1],n=Math.hypot(o.clientX-t.clientX,o.clientY-t.clientY);if(j>0){const e=n/j;$=Math.min(Math.max(F*e,E),w),G()}}},{passive:!1}),s.mainPhoto.addEventListener("touchend",e=>{e.touches.length<2&&(j=0)});let D=0,T=0,Y=0;function z(){s.loading.style.display="none",s.noPhotos.style.display="block"}document.querySelector(".photo-viewer").addEventListener("touchstart",e=>{1===e.touches.length&&1===$&&(D=e.touches[0].clientX,T=e.touches[0].clientY,Y=Date.now())},{passive:!0}),document.querySelector(".photo-viewer").addEventListener("touchend",e=>{if(1!==$)return;if(0===D)return;const t=e.changedTouches[0].clientX,o=e.changedTouches[0].clientY,n=Date.now()-Y,l=t-D,i=o-T;Math.abs(l)>Math.abs(i)&&Math.abs(l)>50&&n<300&&I(l>0?"prev":"next"),D=0,T=0},{passive:!0}),s.zoomIn&&s.zoomIn.addEventListener("click",()=>{$<w&&($=Math.min($+.25,w),G())}),s.zoomOut&&s.zoomOut.addEventListener("click",()=>{$>E&&($=Math.max($-.25,E),1===$&&(k=0,B=0),G())}),s.zoomReset&&s.zoomReset.addEventListener("click",()=>{C()}),s.mainPhoto.addEventListener("dblclick",e=>{e.preventDefault(),$>1?C():($=2,k=0,B=0,G())}),window.addEventListener("popstate",e=>{e.state&&void 0!==e.state.photoIndex&&(clearTimeout(f),y=!0,b=Date.now(),p(e.state.photoIndex,!1,!1),f=setTimeout(()=>{y=!1},300))}),document.addEventListener("keydown",e=>{if("Escape"===e.key){const e=document.querySelector(".photo-metadata");if(e&&e.classList.contains("mobile-visible"))return void g();if($>1)return void C();if(l&&"photo"===i)return void u()}if("r"===e.key||"R"===e.key)return console.log("Reloading gallery..."),void location.reload();0!==n.length&&("ArrowLeft"===e.key?I("prev"):"ArrowRight"===e.key&&I("next"))}),window.photographyGallery={getOldestPhotoInfo:function(){if(0===n.length)return null;const e=n[0],o=new Date(e.date);return{month:o.toLocaleDateString("en-US",{month:"long"}),year:o.getFullYear(),image:e.src||t+e.file}},photoCount:e.length};let P=(new Date).getMonth();setInterval(()=>{const e=(new Date).getMonth();e!==P&&(console.log("New month detected, rebuilding timeline..."),P=e,n.length>0&&r())},6e4),async function(){0!==e.length?async function(){const i=e.length,d=[];s.loading.textContent=`Loading photos (0/${i})...`;for(let o=0;o<e.length;o++){const n=e[o],l=(async()=>{try{const e=Date.now(),l=`${t}${n.file}?v=${e}`;return new Promise(async(e,t)=>{const i=new Image;i.onload=async function(){console.log(`✓ Loaded: ${n.file} (${i.naturalWidth}x${i.naturalHeight})`);let t=null,a=n.date;try{"undefined"==typeof exifr?console.warn("  exifr library not loaded"):(t=await exifr.parse(l,{tiff:!0,exif:!0,gps:!0,interop:!1}),t?.DateTimeOriginal&&!n.date&&(a=t.DateTimeOriginal.toISOString().split("T")[0]),t?(console.log(`  EXIF: ${t?.Make||"N/A"} ${t?.Model||""} | GPS: ${t?.latitude?"Yes":"No"}`),console.log(`  GPS Debug - lat: ${t?.latitude}, lng: ${t?.longitude}, GPSLatitude: ${t?.GPSLatitude}`)):console.warn(`  No EXIF data found in ${n.file}`))}catch(e){console.warn(`  EXIF parse error for ${n.file}:`,e.message)}e({...n,index:o,img:i,src:l,width:i.naturalWidth,height:i.naturalHeight,date:a,exif:t})},i.onerror=function(){console.error(`✗ Failed to load: ${n.file}`),t(new Error(`Failed to load: ${n.file}`))},i.src=l})}catch(e){return console.error(`✗ Error processing ${n.file}:`,e),null}})();d.push(l)}(await Promise.allSettled(d)).forEach(e=>{"fulfilled"===e.status&&null!==e.value&&n.push(e.value)}),console.log(`Loaded ${n.length} of ${i} photos`),n.length>0?function(){s.loading.style.display="none",r();const e=new URLSearchParams(window.location.search).get("photo");let i=n.length-1;if(e){const t=parseInt(e,10)-1;t>=0&&t<n.length&&(i=t)}l?(function(){if(!s.mobileGrid)return;s.mobileGrid.innerHTML="";const e=[...n].reverse(),o=new Map;e.forEach((e,t)=>{const l=a(e.date).getFullYear();o.has(l)||o.set(l,[]);const i=n.length-1-t;o.get(l).push({photo:e,originalIndex:i})}),o.forEach((e,o)=>{const n=document.createElement("div");n.className="mobile-grid-year-wrapper";const l=document.createElement("div");l.className="mobile-grid-year",l.textContent=o,n.appendChild(l),s.mobileGrid.appendChild(n);const i=document.createElement("div");i.className="mobile-grid-section";for(let o=0;o<e.length;o+=2){const{photo:n,originalIndex:l}=e[o],a=e[o+1],s=a?a.photo:null,r=a?a.originalIndex:null,d=n.width/n.height,c=s?s.width/s.height:d,u=d+c,h=s?d/u*100:100,g=s?c/u*100:0,p=document.createElement("div");p.className="mobile-grid-item",p.dataset.photoIndex=l,p.style.width=`calc(${h}% - 1px)`;const y=document.createElement("img");if(y.src=n.src||t+n.file,y.alt=n.file,y.loading="lazy",p.appendChild(y),p.addEventListener("click",()=>{m(l)}),i.appendChild(p),s){const e=document.createElement("div");e.className="mobile-grid-item",e.dataset.photoIndex=r,e.style.width=`calc(${g}% - 1px)`;const o=document.createElement("img");o.src=s.src||t+s.file,o.alt=s.file,o.loading="lazy",e.appendChild(o),e.addEventListener("click",()=>{m(r)}),i.appendChild(e)}}s.mobileGrid.appendChild(i)}),console.log(`Built mobile grid with ${n.length} photos across ${o.size} years`)}(),function(){const e=document.querySelector(".mobile-timeline");if(!e)return;const t=new Map;n.forEach((e,o)=>{const n=a(e.date),l=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`;t.has(l)||t.set(l,[]),t.get(l).push({...e,globalIndex:o})});const o=a(n[0].date),l=a(n[n.length-1].date),i=[];let s=new Date(o.getFullYear(),o.getMonth(),1);const r=new Date(l.getFullYear(),l.getMonth(),1);for(;s<=r;){const e=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`;i.push({key:e,year:s.getFullYear(),month:s.getMonth(),photos:t.get(e)||[]}),s.setMonth(s.getMonth()+1)}c={allMonths:i,firstDate:o,lastDate:l};const d=Math.max(...i.map(e=>e.photos.length),1),m=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],u=i.map((e,t)=>({x:t/(i.length-1||1)*100,y:22-e.photos.length/d*18,month:e}));const h=function(e){if(e.length<2)return"";let t=`M ${e[0].x} ${e[0].y}`;for(let o=0;o<e.length-1;o++){const n=e[0===o?o:o-1],l=e[o],i=e[o+1],a=e[o+2<e.length?o+2:o+1],s=.5;t+=` C ${l.x+(i.x-n.x)*s} ${l.y+(i.y-n.y)*s}, ${i.x-(a.x-l.x)*s} ${i.y-(a.y-l.y)*s}, ${i.x} ${i.y}`}return t}(u),g=`${h} L ${u[u.length-1].x} 30 L ${u[0].x} 30 Z`,p=`${m[o.getMonth()]} ${o.getFullYear()}`,y=`${m[l.getMonth()]} ${l.getFullYear()}`;e.innerHTML=`\n            <div class="mobile-timeline-track">\n                <div class="mobile-timeline-graph">\n                    <svg viewBox="0 0 100 30" preserveAspectRatio="none">\n                        <defs>\n                            <linearGradient id="timeline-gradient" x1="0%" y1="0%" x2="0%" y2="100%">\n                                <stop offset="0%" stop-color="rgba(255, 255, 255, 0.3)" />\n                                <stop offset="100%" stop-color="rgba(255, 255, 255, 0)" />\n                            </linearGradient>\n                        </defs>\n                        <path class="mobile-timeline-area" d="${g}" />\n                        <path class="mobile-timeline-line" d="${h}" />\n                    </svg>\n                    <div class="mobile-timeline-indicator" id="mobile-timeline-indicator"></div>\n                </div>\n            </div>\n            <div class="mobile-timeline-labels">\n                <span class="mobile-timeline-label-item">${p}</span>\n                <span class="mobile-timeline-label-item">${y}</span>\n            </div>\n            <div class="mobile-timeline-current" id="mobile-timeline-current"></div>\n        `}(),function(){s.mobileCloseBtn&&s.mobileCloseBtn.addEventListener("click",e=>{e.preventDefault(),u()}),s.mobileInfoBtn&&s.mobileInfoBtn.addEventListener("click",e=>{e.preventDefault(),h()});const e=document.querySelector(".photo-metadata");e&&e.addEventListener("click",t=>{t.target===e&&g()});const t=document.getElementById("info-close-btn");t&&t.addEventListener("click",e=>{e.preventDefault(),g()}),function(){const e=document.querySelector(".photo-viewer"),t=document.getElementById("main-photo"),n=document.getElementById("gallery-layout"),l=document.getElementById("mobile-grid-view");if(!e||!t)return;let i=0,a=0,s=0,r=!1,d=!1,c=null;let m=0,p=0,y=0;e.addEventListener("touchstart",e=>{document.querySelector(".photo-metadata.mobile-visible")||(i=e.changedTouches[0].clientX,a=e.changedTouches[0].clientY,s=a,m=a,p=Date.now(),y=0,r=!1,d=!1,c=null,t.style.transition="none",n&&(n.style.transition="none"),l&&(l.style.display="block",l.style.opacity="0",l.style.transition="none"))},{passive:!0}),e.addEventListener("touchmove",e=>{if(document.querySelector(".photo-metadata.mobile-visible"))return;const o=e.changedTouches[0].clientX,u=e.changedTouches[0].clientY,h=o-i,g=u-a;if(!c&&(Math.abs(h)>10||Math.abs(g)>10)&&(Math.abs(g)>Math.abs(h)?(c="vertical",r=!0):(c="horizontal",d=!0)),"vertical"===c&&g>0){s=u;const e=Date.now(),o=e-p;o>0&&(y=(u-m)/o),m=u,p=e;const i=Math.min(g/120,1),a=1-.4*i,r=16*i;t.style.transform=`translateY(${g}px) scale(${a})`,t.style.borderRadius=`${r}px`,n&&(n.style.background=`rgba(0, 0, 0, ${1-.8*i})`),l&&(l.style.opacity=String(.8*i))}},{passive:!0}),e.addEventListener("touchend",e=>{if(document.querySelector(".photo-metadata.mobile-visible"))return;const s=e.changedTouches[0].clientX,r=e.changedTouches[0].clientY,d=s-i,m=r-a;if(!("vertical"===c&&m>0))return"horizontal"===c&&Math.abs(d)>50?(t.style.transform="",t.style.opacity="",t.style.borderRadius="",t.style.transition="",n&&(n.style.background="",n.style.transition=""),l&&(l.style.display="none",l.style.opacity="",l.style.transition=""),void I(d<0?"next":"prev")):"vertical"===c&&m<-50?(t.style.transform="",t.style.opacity="",t.style.borderRadius="",t.style.transition="",n&&(n.style.background="",n.style.transition=""),l&&(l.style.display="none",l.style.opacity="",l.style.transition=""),void h()):(t.style.transition="transform 0.3s ease, opacity 0.3s ease, border-radius 0.3s ease",t.style.transform="",t.style.opacity="",t.style.borderRadius="",l&&(l.style.transition="opacity 0.3s ease",l.style.opacity="0"),void setTimeout(()=>{t.style.transition="",n&&(n.style.background="",n.style.transition=""),l&&(l.style.display="none",l.style.opacity="",l.style.transition="")},300));if(m>120||y>.4){const e=function(){const e=document.querySelector(`.mobile-grid-item[data-photo-index="${o}"]`);return e?e.getBoundingClientRect():null}(),i=t.getBoundingClientRect();let a=0,s=window.innerHeight,r=.3;if(e){const t=i.left+i.width/2,o=i.top+i.height/2;a=e.left+e.width/2-t,s=e.top+e.height/2-o,r=e.width/i.width}t.style.transition="transform 0.25s ease-out, opacity 0.25s ease-out, border-radius 0.25s ease-out",n&&(n.style.transition="background 0.25s ease-out"),l&&(l.style.transition="opacity 0.25s ease-out"),t.style.transform=`translate(${a}px, ${s}px) scale(${r})`,t.style.opacity="0",t.style.borderRadius="8px",n&&(n.style.background="transparent"),l&&(l.style.opacity="1"),setTimeout(()=>{t.style.transition="",t.style.transform="",t.style.opacity="",t.style.borderRadius="",n&&(n.style.transition="",n.style.background=""),l&&(l.style.transition=""),u()},250)}else t.style.transition="transform 0.3s cubic-bezier(0.2, 0.9, 0.3, 1), opacity 0.3s ease, border-radius 0.3s ease",n&&(n.style.transition="background 0.3s ease"),l&&(l.style.transition="opacity 0.3s ease"),t.style.transform="",t.style.opacity="",t.style.borderRadius="",n&&(n.style.background=""),l&&(l.style.opacity="0"),setTimeout(()=>{t.style.transition="",n&&(n.style.transition=""),l&&(l.style.display="none",l.style.transition="",l.style.opacity="")},300)},{passive:!0});const f=document.querySelector(".photo-metadata");if(f){let e=0;f.addEventListener("touchstart",t=>{e=t.changedTouches[0].screenY},{passive:!0}),f.addEventListener("touchend",t=>{t.changedTouches[0].screenY-e>50&&g()},{passive:!0})}}()}(),e?m(i):(s.galleryLayout.style.display="none",s.mobileGridView&&(s.mobileGridView.style.display="block"))):(s.galleryLayout.style.display="flex",setTimeout(()=>{y=!0,b=Date.now(),p(i),setTimeout(()=>{y=!1},1e3)},100)),function(){const e=document.getElementById("nav-prev"),t=document.getElementById("nav-next");e&&e.addEventListener("click",()=>I("prev")),t&&t.addEventListener("click",()=>I("next")),M()}()}():z()}():z()}()}();